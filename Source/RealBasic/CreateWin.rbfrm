#tag WindowBegin Window CreateWin   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   731   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   True   MaxWidth        =   32000   MenuBar         =   1107226425   MenuBarVisible  =   True   MinHeight       =   400   MinimizeButton  =   True   MinWidth        =   600   Placement       =   3   Resizeable      =   False   Title           =   "Create License"   Visible         =   True   Width           =   600   Begin TextArea PrivateKeyFld      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   True      BackColor       =   16777215      Bold            =   ""      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   79      HelpTag         =   "Add a private key created with the AquaticPrime Developer utility"      HideSelection   =   True      Index           =   -2147483648      Italic          =   ""      Left            =   20      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Mask            =   ""      Multiline       =   True      ReadOnly        =   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   True      TabIndex        =   10      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   312      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   560   End   Begin Label st      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   "Add a private key created with the AquaticPrime Developer utility"      Index           =   0      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   8      TabPanelIndex   =   0      Text            =   "Private key"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   287      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   76   End   Begin Label st      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   1      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   0      TabPanelIndex   =   0      Text            =   "Name:"      TextAlign       =   2      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   24      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   69   End   Begin Label st      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   2      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   2      TabPanelIndex   =   0      Text            =   "Email:"      TextAlign       =   2      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   56      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   69   End   Begin TextField NameFld      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   ""      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      Italic          =   ""      Left            =   101      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   False      Mask            =   ""      Password        =   ""      ReadOnly        =   ""      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   22      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   479   End   Begin TextField EmailFld      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   ""      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      Italic          =   ""      Left            =   101      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   False      Mask            =   ""      Password        =   ""      ReadOnly        =   ""      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   56      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   480   End   Begin Rectangle Rectangle1      AutoDeactivate  =   True      BorderWidth     =   1      BottomRightColor=   0      Enabled         =   True      FillColor       =   16777215      Height          =   54      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   125      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   False      Scope           =   0      TabIndex        =   21      TabPanelIndex   =   0      Top             =   597      TopLeftColor    =   0      Visible         =   True      Width           =   455      Begin Label FileSaveTxt         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   40         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "Rectangle1"         Italic          =   ""         Left            =   128         LockBottom      =   True         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   False         Multiline       =   True         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         Text            =   ""         TextAlign       =   0         TextColor       =   0         TextFont        =   "SmallSystem"         TextSize        =   0         TextUnit        =   0         Top             =   604         Transparent     =   False         Underline       =   ""         Visible         =   True         Width           =   445      End   End   Begin Label st      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   3      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   20      TabPanelIndex   =   0      Text            =   "Save File To:"      TextAlign       =   2      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   597      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   93   End   Begin PushButton MakeBtn      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "Generate"      Default         =   False      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   475      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   23      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   691      Underline       =   ""      Visible         =   True      Width           =   105   End   Begin PushButton SaveLocBtn      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "Change Location…"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   125      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   22      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "SmallSystem"      TextSize        =   0      TextUnit        =   0      Top             =   659      Underline       =   ""      Visible         =   True      Width           =   128   End   Begin TextArea PublicKeyFld      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   True      BackColor       =   16777215      Bold            =   ""      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   79      HelpTag         =   "Add a public key created with the AquaticPrime Developer utility"      HideSelection   =   True      Index           =   -2147483648      Italic          =   ""      Left            =   20      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Mask            =   ""      Multiline       =   True      ReadOnly        =   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   True      TabIndex        =   13      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   196      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   560   End   Begin Label st      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   "Add a public key created with the AquaticPrime Developer utility"      Index           =   4      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   11      TabPanelIndex   =   0      Text            =   "Public key (drag or paste hex)"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   171      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   195   End   Begin TextArea ObfuscatedFld      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   True      BackColor       =   16777215      Bold            =   ""      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   79      HelpTag         =   "Code for obfuscating the public key in your application is automatically generated here, or you can create a module to drag into your project by clicking ""Create Module"" below."      HideSelection   =   True      Index           =   -2147483648      Italic          =   ""      Left            =   20      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Mask            =   ""      Multiline       =   True      ReadOnly        =   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   True      TabIndex        =   16      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   428      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   560   End   Begin Label st      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   "Code for obfuscating the public key in your application is automatically generated here, or you can create a module to drag into your project by clicking ""Create Module"" below."      Index           =   5      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   14      TabPanelIndex   =   0      Text            =   "Obfuscated public key"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   403      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   150   End   Begin Label st      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   45      HelpTag         =   ""      Index           =   9      InitialParent   =   ""      Italic          =   ""      Left            =   13      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   4      TabPanelIndex   =   0      Text            =   "Additional\rFields:"      TextAlign       =   2      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   102      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   76   End   Begin Listbox KeyBox      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   ""      Border          =   True      ColumnCount     =   2      ColumnsResizable=   ""      ColumnWidths    =   ""      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   -1      Enabled         =   True      EnableDrag      =   ""      EnableDragReorder=   ""      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   True      HeadingIndex    =   -1      Height          =   69      HelpTag         =   ""      Hierarchical    =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   "Key	Value"      Italic          =   ""      Left            =   101      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      RequiresSelection=   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollBarVertical=   True      SelectionType   =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   90      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   479      _ScrollWidth    =   -1   End   Begin BevelButton MinusBtn      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   0      Bevel           =   0      Bold            =   True      ButtonType      =   0      Caption         =   "-"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   False      HasBackColor    =   False      HasMenu         =   0      Height          =   22      HelpTag         =   ""      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   558      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      MenuValue       =   0      Scope           =   0      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   0      TextFont        =   "System"      TextSize        =   ""      TextUnit        =   0      Top             =   159      Underline       =   False      Value           =   False      Visible         =   True      Width           =   22   End   Begin BevelButton PlusBtn      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   0      Bevel           =   0      Bold            =   True      ButtonType      =   0      Caption         =   "+"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   False      HasMenu         =   0      Height          =   22      HelpTag         =   ""      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   536      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      MenuValue       =   0      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   0      TextFont        =   "System"      TextSize        =   ""      TextUnit        =   0      Top             =   159      Underline       =   False      Value           =   False      Visible         =   True      Width           =   22   End   Begin Label st      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   10      InitialParent   =   ""      Italic          =   ""      Left            =   13      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   18      TabPanelIndex   =   0      Text            =   "File extension:"      TextAlign       =   2      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   557      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   100   End   Begin TextField extFld      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   ""      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      Italic          =   ""      Left            =   125      LimitText       =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   False      Mask            =   ""      Password        =   ""      ReadOnly        =   ""      Scope           =   0      TabIndex        =   19      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   556      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   455   End   Begin PushButton CreateModuleBtn      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "Create Module…"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   "Create a Real Studio module with obfuscation code"      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   438      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   17      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   519      Underline       =   ""      Visible         =   True      Width           =   142   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Close()		  App.Prefs.Sync		End Sub	#tag EndEvent	#tag Event		Sub Deactivate()		  App.Prefs.Sync		End Sub	#tag EndEvent	#tag Event		Sub Open()		  dim savePath as String = App.Prefs.Value ("Creation SavePath", SpecialFolder.Documents.AbsolutePath)		  try		    self.SaveLoc = new FolderItem (savePath, FolderItem.PathTypeAbsolute)		  catch		    self.SaveLoc = SpecialFolder.Documents		  end		  ShowSaveLocation		  		  ObfuscatedFld.Text = ObfuscateKey		  		  checkState		End Sub	#tag EndEvent	#tag MenuHandler		Function FileClose() As Boolean Handles FileClose.Action			self.Close			return true		End Function	#tag EndMenuHandler	#tag Method, Flags = &h21		Private Sub checkState()		  MakeBtn.Enabled = PublicKeyFld.Text.Trim <> "" and NameFld.Text.Trim <> "" and EmailFld.Text.Trim <> "" and SaveLoc <> nil		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function Generate(ByRef fileOut As FolderItem, ByRef errMsgOut as String) As Boolean		  dim a As new AquaticPrime(PublicKeyFld.Text, PrivateKeyFld.Text)		  		  dim d As new Dictionary		  d.Value("Name") = NameFld.Text		  d.Value("Email") = EmailFld.Text		  		  for i As Integer = 0 to KeyBox.ListCount - 1		    dim key As String = Keybox.Cell(i, 0).Trim		    dim value As String = Keybox.Cell(i, 1)		    if key <> "" Then		      if value = "<sqldate>" then		        dim now as new Date		        value = now.SQLDate		      end		      d.Value(key) = value		    end if		  next		  		  dim ext As String = extFld.Text.Trim		  if ext = "" Then ext = "plist"		  dim fName As String = NameFld.Text.Trim		  		  // always write a new file, not overwriting existing ones		  dim i as Integer = 1		  do		    dim suffix as String		    if i > 1 then		      suffix = "-"+Format(i,"#")		    end if		    fileOut = self.SaveLoc.Child (fName + suffix + "." + ext)		    if not fileOut.Exists then exit		    i = i + 1		  loop		  		  dim ok as Boolean = a.WriteLicenseFileForDictionary(d, fileOut)		  if not ok then		    errMsgOut = a.LastError		  else		    errMsgOut = ""		  end if		  		  return ok		End Function	#tag EndMethod	#tag Method, Flags = &h21		Private Sub KeyBoxAdd()		  Keybox.AddRow ""		  Keybox.EditCell (keybox.LastIndex, 0)		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Sub KeyBoxLoad()		  dim entries as Dictionary = App.Prefs.Value ("Creation KeyBox", nil)		  		  KeyBox.DeleteAllRows		  if entries <> nil then		    for each key as String in entries.Keys		      KeyBox.AddRow key		      KeyBox.Cell (KeyBox.LastIndex, 1) = entries.Value(key)		    next		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Sub KeyBoxRemove()		  dim row As Integer = Keybox.ListIndex		  if row >= 0 then		    KeyBox.RemoveRow row		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Sub KeyBoxSave()		  dim entries as new Dictionary		  for i as Integer = 0 to KeyBox.ListCount-1		    dim key as String = KeyBox.Cell(i, 0).Trim		    if key <> "" then		      entries.Value (key) = KeyBox.Cell(i, 1)		    end if		  next		  		  App.Prefs.Value ("Creation KeyBox") = entries		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Function ObfuscateKey() As String		  if PublicKeyFld.Text.Trim = "" Then		    Return ""		  end if		  		  dim pk As String = PublicKeyFld.Text.Trim		  		  Return GetKey(pk)		  		  		End Function	#tag EndMethod	#tag Method, Flags = &h21		Private Sub ShowSaveLocation()		  if self.SaveLoc is nil Then		    FileSaveTxt.Text = ""		  Else		    FileSaveTxt.Text = self.SaveLoc.AbsolutePath		  end if		End Sub	#tag EndMethod	#tag Property, Flags = &h21		Private SaveLoc As FolderItem	#tag EndProperty#tag EndWindowCode#tag Events PrivateKeyFld	#tag Event		Sub TextChange()		  App.Prefs.Value ("Creation PrivKey") = me.Text		  if PublicKeyFld.Text.Trim <> "" Then		    ObfuscatedFld.Text = ObfuscateKey		  end if		  checkState		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.Text = App.Prefs.Value ("Creation PrivKey", "")		End Sub	#tag EndEvent#tag EndEvents#tag Events NameFld	#tag Event		Sub TextChange()		  App.Prefs.Value ("Creation Name") = me.Text		  checkState		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.Text = App.Prefs.Value ("Creation Name", "")		End Sub	#tag EndEvent#tag EndEvents#tag Events EmailFld	#tag Event		Sub TextChange()		  App.Prefs.Value ("Creation Email") = me.Text		  checkState		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.Text = App.Prefs.Value ("Creation Email", "")		End Sub	#tag EndEvent#tag EndEvents#tag Events MakeBtn	#tag Event		Sub Action()		  dim ok as Boolean, file As FolderItem, error as String		  ok = Generate (file, error)		  		  if not ok Then		    MsgBox "There was a problem creating the licence file." + EndOfLine + error		  Else		    MsgBox "The license file was saved at: " + file.AbsolutePath		  End If		  		End Sub	#tag EndEvent#tag EndEvents#tag Events SaveLocBtn	#tag Event		Sub Action()		  dim dlg As new SelectFolderDialog		  dlg.PromptText = "Location for saving license files"		  dlg.InitialDirectory = SpecialFolder.Documents		  self.SaveLoc = dlg.ShowModalWithin(self)		  		  App.Prefs.Value ("Creation SavePath") = self.SaveLoc.AbsolutePath		  		  ShowSaveLocation		  		End Sub	#tag EndEvent#tag EndEvents#tag Events PublicKeyFld	#tag Event		Sub TextChange()		  App.Prefs.Value ("Creation PubKey") = me.Text		  if PrivateKeyFld.Text.Trim <> "" Then		    ObfuscatedFld.Text = ObfuscateKey		  end if		  checkState		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.Text = App.Prefs.Value ("Creation PubKey", "")		End Sub	#tag EndEvent#tag EndEvents#tag Events KeyBox	#tag Event		Sub Change()		  KeyBoxSave		  MinusBtn.Enabled = me.ListIndex >= 0		End Sub	#tag EndEvent	#tag Event		Sub DoubleClick()		  dim column As Integer = me.ColumnFromXY (System.MouseX-me.Left-self.Left, System.MouseY-me.Top-self.Top)		  if column >= 0 Then		    me.EditCell (me.ListIndex, column)		  end if		End Sub	#tag EndEvent	#tag Event		Function CellKeyDown(row as Integer, column as Integer, key as String) As Boolean		  if key.Asc = 9 then		    // Tab key was pressed		    		    if column = 0 then		      me.EditCell(row, 1)		    else		      me.EditCell(row, 0)		    end		    		    return true		    		  elseif key.Asc = 3 or key.Asc = 13 then		    // Return or Enter was pressed -> finish editing		    		    dim firstCell as String = me.Cell(row, 0)		    if firstCell.Trim = "" then		      // empty -> remove row again		      me.RemoveRow row		    end		    		  end		End Function	#tag EndEvent	#tag Event		Sub Open()		  KeyBoxLoad		End Sub	#tag EndEvent	#tag Event		Function KeyDown(Key As String) As Boolean		  if key = Chr(13) then		    // Return key was pressed		    if me.ListIndex >= 0 then		      // edit selected row		      me.EditCell (me.ListIndex, 1)		    else		      // add new row		      KeyBoxAdd		    end		  elseif key = Chr(8) or key = Chr(127) then		    // delete selected entry		    if MinusBtn.Enabled then		      KeyBoxRemove		    else		      beep		    end if		  end if		End Function	#tag EndEvent#tag EndEvents#tag Events MinusBtn	#tag Event		Sub Action()		  KeyBoxRemove		End Sub	#tag EndEvent#tag EndEvents#tag Events PlusBtn	#tag Event		Sub Action()		  KeyBoxAdd		End Sub	#tag EndEvent#tag EndEvents#tag Events extFld	#tag Event		Sub Open()		  me.Text = App.Prefs.Value ("Creation FileExtension", "plist")		End Sub	#tag EndEvent	#tag Event		Sub TextChange()		  App.Prefs.Value ("Creation FileExtension") = me.Text		End Sub	#tag EndEvent#tag EndEvents#tag Events CreateModuleBtn	#tag Event		Sub Action()		  dim n As String = GetInfoDlg.NumInit("Minimum number of methods to create (1 - 8)", "4").Trim		  if n = "" Then Return		  		  if n = "0" Then		    Beep		    Return		  end if		  		  CreateObscurePubKeyCode PublicKeyFld.Text, val(n)		  		  		End Sub	#tag EndEvent#tag EndEvents