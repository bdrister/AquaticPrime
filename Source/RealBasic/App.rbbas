#tag ClassProtected Class AppInherits Application	#tag Event		Function HandleAppleEvent(theEvent As AppleEvent, eventClass As String, eventID As String) As Boolean		  // To keep things simple, the AppleEvents here work on the preset values for the		  // Public/Private Keys and KeyBox values.		  // The only variables are the Name and Email fields, passed to the direct parameter,		  // separated by a Tab character		  		  if StrComp (eventClass, "Aqu1", 0) = 0 and StrComp (eventID, "gLic", 0) = 0 then		    dim nameAndEmail as String = theEvent.StringParam("----")		    dim name as String = nameAndEmail.NthField(Chr(9), 1) // Name in first field		    dim email as String = nameAndEmail.NthField(Chr(9), 2) // E-Mail in second field		    		    CreateWin.NameFld.Text = name		    CreateWin.EmailFld.Text = email		    		    dim ok as Boolean, file As FolderItem, error as String		    ok = CreateWin.Generate (file, error)		    		    if ok Then		      theEvent.ReplyFolderItem = file		    else		      theEvent.ReplyString = error		    End If		    		    return true		  end if		End Function	#tag EndEvent	#tag MenuHandler		Function FileCreateLicense() As Boolean Handles FileCreateLicense.Action			CreateWin.Show			Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileValidateLicense() As Boolean Handles FileValidateLicense.Action			ValidateWin.Show			Return True					End Function	#tag EndMenuHandler	#tag Property, Flags = &h21		Private mPrefs As TTsSmartPreferences	#tag EndProperty	#tag ComputedProperty, Flags = &h0		#tag Getter			Get			  if mPrefs = nil then			    mPrefs = new TTsSmartPreferences ("AquaticPrime Developer RB")			  end			  return mPrefs			End Get		#tag EndGetter		Prefs As TTsSmartPreferences	#tag EndComputedProperty	#tag Constant, Name = kEditClear, Type = String, Dynamic = False, Default = \"&Delete", Scope = Public		#Tag Instance, Platform = Windows, Language = Default, Definition  = \"&Delete"		#Tag Instance, Platform = Linux, Language = Default, Definition  = \"&Delete"	#tag EndConstant	#tag Constant, Name = kFileQuit, Type = String, Dynamic = False, Default = \"&Quit", Scope = Public		#Tag Instance, Platform = Windows, Language = Default, Definition  = \"E&xit"	#tag EndConstant	#tag Constant, Name = kFileQuitShortcut, Type = String, Dynamic = False, Default = \"", Scope = Public		#Tag Instance, Platform = Mac OS, Language = Default, Definition  = \"Cmd+Q"		#Tag Instance, Platform = Linux, Language = Default, Definition  = \"Ctrl+Q"	#tag EndConstant	#tag ViewBehavior	#tag EndViewBehaviorEnd Class#tag EndClass