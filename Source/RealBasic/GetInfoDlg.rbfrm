#tag WindowBegin Window GetInfoDlg   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   True   Composite       =   False   Frame           =   1   FullScreen      =   False   HasBackColor    =   False   Height          =   178   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   True   Title           =   ""   Visible         =   True   Width           =   352   Begin Label promptLabel      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   ""      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   0      TabPanelIndex   =   0      Text            =   "Untitled"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   14      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   312   End   Begin TextField infoFld      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   ""      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LimitText       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   ""      Mask            =   ""      Password        =   ""      ReadOnly        =   ""      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   68      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   312   End   Begin Pushbutton OKBtn      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "OK"      Default         =   True      Enabled         =   False      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   252      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   True      LockTop         =   ""      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   138      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin Pushbutton CancelBtn      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   True      Caption         =   "Cancel"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   160      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   True      LockTop         =   ""      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   138      Underline       =   ""      Visible         =   True      Width           =   80   EndEnd#tag EndWindow#tag WindowCode	#tag Method, Flags = &h0		Function init(prompt As String, default As String) As String		  promptLabel.Text = prompt		  infoFld.Text = default		  		  self.ShowModal		  		  Return self.result		  		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function NumInit(prompt As String, default As String) As String		  self.doNum = True		  		  Return init(prompt, default)		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function urlInit(prompt As String, default As String) As String		  self.doURL = True		  		  Return init(prompt, default)		  		End Function	#tag EndMethod	#tag Property, Flags = &h21		Private doNum As Boolean	#tag EndProperty	#tag Property, Flags = &h21		Private doURL As Boolean	#tag EndProperty	#tag Property, Flags = &h21		Private result As String	#tag EndProperty#tag EndWindowCode#tag Events infoFld	#tag Event		Sub TextChange()		  dim b As Boolean = me.Text.Trim <> ""		  		  if self.doURL Then		    // add checking for URL if desired		    // b = b and ...		  end if		  		  OKBtn.Enabled = b		End Sub	#tag EndEvent	#tag Event		Function KeyDown(Key As String) As Boolean		  if self.doURL Then		    if me.Text = "" Then		      if key = "h" Then		        me.Text = "http://"		        me.SelStart = len(me.Text)		        Return True		      Elseif key = "m" Then		        me.Text = "mailto:"		        me.SelStart = len(me.Text)		        Return True		      End If		    end if		    		  Elseif self.doNum Then		    if Keyboard.AsyncCommandKey or key.Asc < 32 Then Return False		    if Instr("0123456789", key) = 0 Then		      Beep		      Return True		    end if		  end if		End Function	#tag EndEvent#tag EndEvents#tag Events OKBtn	#tag Event		Sub Action()		  self.result = infoFld.Text		  self.Close		End Sub	#tag EndEvent#tag EndEvents#tag Events CancelBtn	#tag Event		Sub Action()		  self.Close		End Sub	#tag EndEvent#tag EndEvents